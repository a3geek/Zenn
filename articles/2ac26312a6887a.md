---
title: "微分積分学の基本定理"
emoji: "🍣"
type: "tech" # tech: 技術記事 / idea: アイデア
topics: ["math"]
published: true
---

$\frac{d}{dx}\int_a^xf(t)dt = f(x)$が成り立つことを微分積分学の基本定理という。

## 定積分と面積
ある連続な関数$f(x)$について区間$[a, b]$を考え、この区間を$a = x_0 < x_1 < \cdots < x_n = b$と分割する。
ここで、それぞれの分割区間において、最小の関数値を高さとする棒グラフ（下図赤線）と、最大の関数値を高さとする棒グラフ（下図青線）を考える。
分割の幅を$\varDelta x$（$\varDelta x$が小さくなるほど分割数$n$は大きくなる）、最小の関数値を高さとする棒グラフの面積を$s(\varDelta x, f)$、最大の関数値を高さとする棒グラフの面積を$S(\varDelta x, f)$とする。

このとき、$f(x)$が

$$\begin{aligned} a\leq x \leq bで積分可能 & \overset{def}\Leftrightarrow \sup s(\varDelta x, f) = \inf S(\varDelta x, f) \\ & \overset{def}\Leftrightarrow \int_a^bf(x)dx \end{aligned}$$

と定義する。
なお、$\sup$は上限、$\inf$は下限を意味し、第2式は$s(\varDelta x, f)$の上限と$S(\varDelta x, f)$の下限が一致することを意味する。
また、$\int_a^bf(x)dx$で求まる値を$x$軸と$f(x)$と$a$と$b$の間で挟まれた領域の面積と定義する。
![](/images/2ac26312a6887a/image01.jpg =200x)


## 微分と微分積分学の基本定理の証明
ある連続な関数$f(t)$について$g(x) = \int_a^xf(t)dt$を考える。
このとき、$g(x)$が微分可能であるとは$\lim_{h \to 0} \frac{g(x+h) - g(x)}{h}$が有限な値を取るということであり、微分積分学の基本定理が成り立つとは$\lim_{h \to 0} \left(\frac{g(x+h) - g(x)}{h} - f(x)\right) = 0$が成り立つということである。
この方程式が成り立つことを確認するために$\left|\frac{g(x+h) - g(x)}{h} - f(x)\right|$を考える。

$$\begin{aligned} \left|\frac{g(x+h) - g(x)}{h} - f(x)\right| &= \left|\frac{1}{h}\int_x^{x+h}f(t)dt-f(x)\right| \quad \left(\because \int_a^{x+h}f(t)dt-\int_a^xf(t)dt = \int_x^{x+h}f(t)dt\right) \\ &= \left|\frac{1}{h}\left(\int_x^{x+h}f(t)dt-f(x)h\right)\right| \\ &= \left|\frac{1}{h}\int_x^{x+h}\left(f(t)-f(x)\right)dt\right| \quad \left(\because f(x)h = \int_x^{x+h}f(x)dt\right) \end{aligned}$$

ここで、$h$が正の方向から$0$になる場合を考える（負の場合についても同様となる）と

$$\begin{aligned} \frac{1}{h}\left|\int_x^{x+h}\left(f(t)-f(x)\right)dt\right| &\leq \frac{1}{h}\int_x^{x+h}\left|f(t)-f(x)\right|dt \\ &\left(\because \left|\int_a^bf(x)dx\right|\leq\int_a^b\left|f(x)\right|dx\right) \end{aligned}$$

右辺について、$t$は区間$[x, x+h]$の間に存在するため、$h$が$0$に近付くほど$f(x)$と$f(t)$の差は小さくなる。
よって、$\left|f(t)-f(x)\right|$を$\epsilon$で抑えることで、イプシロンデルタ論法より

$$\frac{1}{h}\int_x^{x+h}\left|f(t)-f(x)\right|dt < \frac{1}{h}\epsilon h = \epsilon$$

が成り立つため、$h \to 0$のとき$\lim_{h \to 0} \left(\frac{g(x+h) - g(x)}{h} - f(x)\right) = 0$が成り立つ。


## 不定積分と原始関数
微分して$f(x)$となる関数を原始関数といい、$F(x) = \int f(x)dx$と定義する。
微分積分学の基本定理は、関数$f(x)$が積分可能であれば原始関数が存在することを示している。

ここで、原始関数より定積分を計算することを考える。
$f(x)$の原始関数を$F(x)$とし、$\int_a^xf(t)dt = G(x)$とすると微分積分学の基本定理より

$$\frac{d}{dx}G(x) = f(x)$$

となる。
このとき、$G(x)$は微分すると$f(x)$となるため、$G(x)$と$F(x)$は定数倍のずれしか存在しない。
よって、$G(x) = F(x) + C$となる。
ここで、$x = a$のとき$G(a) = 0 = F(a) + C$となるため、$C = -F(a)$となる。
よって、$\int_a^xf(t)dt = F(x) - F(a)$が成り立つ。
