---
title: "ラプラス変換とZ変換"
emoji: "🍣"
type: "tech" # tech: 技術記事 / idea: アイデア
topics: ["math"]
published: true
---

フーリエ変換について：[フーリエ解析と計算機](https://zenn.dev/a3geek/books/5d936cce8e36a1)


# ラプラス変換
非周期関数$f(x)$を求めるフーリエ解析は、フーリエ変換を用いて

$$\begin{aligned} f(x) &\sim \frac{1}{2\pi}\int_{-\infty}^{\infty}F(\omega)e^{j\omega x}d\omega \\ F(\omega) &= \int_{-\infty}^{\infty}f(t)e^{-j\omega t}dt \end{aligned}$$

で表されるが、フーリエ変換は利用頻度の高い関数でも、積分が発散してしまう問題がある。
例えば$f(t) = 1$のとき、

$$F(\omega) = \int_{-\infty}^{\infty}f(t)e^{-j\omega t}dt = \int_{-\infty}^{\infty}e^{-j\omega t}dt = 収束しない$$

となり、計算ができない。

そこで、関数$f(t)$を積分できる形に変形することを考える。
まず、関数$f(t)$は$f(t) = 0 \quad (t < 0)$であるとする。
ここで、$a > 0$のとき$t \to \infty$で非常に速く$0$に収束する関数$e^{-at}$を考え、この関数と$f(t)$との積を考える。
つまり、関数$f(t)$に非常に速く収束する関数$e^{-at}$を畳み込むことで、関数$f(t)$に収束性を与えるのである。
|元の関数|畳み込んだ関数|
|---|---|
|![](/images/838fefd37819a9/image01.jpg =200x)|![](/images/838fefd37819a9/image04.jpg =200x)|

関数の積$f(t)e^{-at}$のフーリエ変換を考えると、

$$\begin{aligned}\int_{-\infty}^{\infty}f(t)e^{-at}e^{-j\omega t}dt = \int_0^{\infty}&f(t)e^{-st}dt \cdots (1) \\ s &= a + j\omega\end{aligned}$$

が得られ、この$(1)$式の右辺を

$$\mathcal{L}[f(s)] = F(s) = \int_0^{\infty}f(t)e^{-st}dt \cdots (2) $$

と表し、$(2)$式を関数$f$の **（片側）ラプラス変換** という。
このとき、$s = a + j\omega$は複素数であり、その存在領域を **複素領域**、**s領域**、**s空間**などといい、変数$t$の存在する空間を **t領域**または **t空間**という。
なお、関数$f(t)$を全ての実数について考えることで

$$\mathcal{B}[f(s)] = F(s) = \int_{-\infty}^{\infty}f(t)e^{-st}dt$$

を得ることができ、これを **両側ラプラス変換** という。
ここで、$(2)$式のフーリエ逆変換は

$$\mathcal{F^{-1}}[F(\omega)] \coloneqq \frac{1}{2\pi}\int_{-\infty}^{\infty} F(\omega)e^{j\omega t}d\omega$$

より、

$$f(t)e^{-at} = \frac{1}{2\pi}\int_{-\infty}^{\infty}F(s)e^{j\omega t}d\omega$$

両辺を$e^{-at}$で割って

$$f(t) = \frac{1}{2\pi}\int_{-\infty}^{\infty}F(s)e^{at + j\omega t}d\omega$$

$s = a + j\omega$なので積分変数を$\omega$から$s$に変換すると$\frac{ds}{d\omega} = j$であり、積分範囲は$a - j\infty$から$a + j\infty$となるので、

$$f(t) = \frac{1}{2\pi j}\int_{a - j\infty}^{a + j\infty}F(s)e^{st}ds \cdots (3)$$

となり、この$(3)$式を **ラプラス逆変換** といい

$$\mathcal{L}^{-1}[f(s)] = \frac{1}{2\pi j}\int_{a - j\infty}^{a + j\infty}F(s)e^{st}ds$$

と表す。

ここで、ラプラス変換の収束性を考える。
ラプラス変換が$s_0 = a_0 + j\omega_0$で求められたとすると、$s = a + j\omega(a \geq a_0)$となる$s$において

$$|e^{-sx}| = |e^{-(a + j\omega)x|}| = |e^{-ax}e^{-j\omega x}| = e^{-ax} \leq e^{-a_0 x} = |e^{-s_0 x}|$$

となり、その$s$においてもラプラス変換は収束する。
したがって、与えられた関数$f(t)$に対して$Re[s] < a$ならラプラス変換が発散し、$Re[s] \geq a$ならラプラス変換が収束するような実数$a$がただ一つ定まる。
この$a$のことを **ラプラス変換の収束座標** といい、$a = -\infty$のとき全ての$s$についてラプラス変換は収束し、$a = \infty$のとき全てのラプラス変換は発散する。
また、収束座標$a$より大きい任意の実数を$\alpha$（$\forall\alpha \in \mathbb{R}, \alpha > a$）とする時、$f(t)$が任意の有限区間で区分的に滑らかであれば、$(3)$式について

$$\frac{1}{2\pi j}\int_{\alpha-j\infty}^{\alpha+j\infty}F(s)e^{sx}ds = \frac{\lim_{a \to t-0}f(a) + \lim_{a \to t+0}f(a)}{2}$$

が成り立つことが知られており、これを **ラプラス変換の反転公式** という。

ここまで、フーリエ変換を拡張してラプラス変換を導出した。
ある関数$f(t)$がフーリエ変換できない時、$f_1(t) = f(t)e^{-st}$を考えることで$f(t)$に収束性を与え、$f_1(t)$に対してフーリエ変換をおこなう、この一連の流れがラプラス変換である。
フーリエ解析とは、ある強さ（フーリエ係数）を持つ波（複素正弦波$e^{j\omega t}$）を重ね合わせることで任意の関数を表せないか、というものであったが、フーリエ変換は単調な波の和を考えているため$t \to \infty$で$0$に収束しない関数を変換できなかった。
そこで、ラプラス変換では増大する波（複素正弦波$e^{st}$）を導入し、指数関数的に拡散する波の和を考えることで、元の関数の発散を抑えフーリエ変換を可能とするのである。
|フーリエ変換|ラプラス変換|
|---|---|
|![](/images/838fefd37819a9/image02.jpg =200x)|![](/images/838fefd37819a9/image03.jpg =200x)|


# z変換
ラプラス変換によって、非周期で連続な関数$f(x)$に収束性を与えることでフーリエ変換が計算できる。
そこで、関数$f$が不連続な関数$f[n]$である場合についても、収束性を与えることを考える。
非周期で不連続な関数$f[n]$のフーリエ変換は、離散時間フーリエ変換より

$$F(\omega) = \sum_{n = -\infty}^{\infty}f[n]e^{-j\omega n}$$

で求められるが、ここでは関数$f[n]$は$f[n] = 0 \quad (n < 0)$であるとする。
ここで、ラプラス変換と同様に$a > 0$のとき$n \to \infty$で非常に速く$0$に収束する関数$e^{-an}$を考え、関数の積$f[n]e^{-an}$の離散時間フーリエ変換を考えると、

$$\begin{aligned} \sum_{n = 0}^{\infty}f[n]e^{-an}e^{-j\omega n} &= \sum_{n = 0}^{\infty}f[n]e^{-(a+j\omega)n} \\ &= \sum_{n = 0}^{\infty}f[n]z^{-n} \cdots (4) \\ &z = e^{a+j\omega} \end{aligned}$$

が得られ、この$(4)$式の右辺を

$$\mathcal{Z}[f[n]] = X(z) = \sum_{n=0}^{\infty}f[n]z^{-n} \cdots (5)$$

と表し、$(5)$式を関数$f$の **（片側）z変換** という。
このとき、$z= e^{a + j\omega}$は複素数である。
なお、関数$f[n]$を全ての実数について考えることで

$$\mathcal{Z}[f[n]] = X(z) = \sum_{n=-\infty}^{\infty}f[n]z^{-n}$$

を得ることができ、これを **両側z変換** という。

ここで、$z$変換の収束性を考える。
$a$を定数として、関数$f[n] = a^n$のとき、z変換は

$$\begin{aligned} X(z) &= \sum_{n=0}^{\infty}a^nz^{-n} \\ &= \sum_{n=0}^{\infty}(az^{-1})^n \\ &= \frac{1}{1-(az^{-1})} \cdots (6) \end{aligned}$$

ここで、$(6)$式の無限等比級数が収束するためには、$|az^{-1}| < 1 \Leftrightarrow |a| < |z|$を満たす必要がある。
これは複素数$z$の平面（$z$平面）において、半径$a$の円の外側を指している。
このように$z$変換の収束する範囲を **収束域** といい、一般に収束域は原点を中心とする円の外側になり、その境界となる円を **収束円** という。
